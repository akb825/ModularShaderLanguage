uniform sampler2D tex;

uniform Transform
{
	mat4 transform;
} block;

uniform vec2[2] texCoords;

sampler_state tex
{
	address_mode_u = repeat;
	address_mode_v = clamp_to_edge;
	min_filter = linear;
	mag_filter = linear;
	mip_filter = anisotropic;
};

[[vertex]] in vec3 position;
[[vertex]] in vec4 color;

[[vertex]] out VertexOut
{
	vec4 color;
} outputs;

[[fragment]] in FragmentIn
{
	vec4 color;
} inputs;

[[fragment]] out vec4 color;

[[vertex]]
void vertShader()
{
	gl_Position = INSTANCE(block).transform*vec4(position, 1.0);
	outputs.color = color;
}

[[fragment]]
void fragShader()
{
	vec4 texResult = texture(tex, uniforms.texCoords[1]);
	color = inputs.color*texResult;
}

pipeline Test
{
	vertex = vertShader;
	fragment = fragShader;
	blend_enable = true;
	src_blend_factor = src_alpha;
	dst_color_blend_factor = one_minus_src_alpha;
	dst_alpha_blend_factor = zero;
}
